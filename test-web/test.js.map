{"version":3,"sources":["webpack:///webpack/bootstrap bca226a038906c3bc13b","webpack:///./test/test.ts","webpack:///./src/index.ts","webpack:///./src/user-fitting-simple.ts","webpack:///./src/drawing-buffer.ts","webpack:///./src/draw-images-aligned.ts","webpack:///./src/draw-with-blur.ts"],"names":[],"mappings":"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","file":"./test-web/test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bca226a038906c3bc13b","import * as S from '../src/index';\r\n\r\nexport function test() {\r\n    console.log('test START');\r\n\r\n    let p0 = getProduct(0);\r\n    let p1 = getProduct(1);\r\n    let p2 = getProduct(2);\r\n    let p3 = getProduct(3);\r\n    let p4 = getProduct(4);\r\n    let p5 = getProduct(5);\r\n    let u0 = getUser(0);\r\n    let u1 = getUser(1);\r\n    let u2 = getUser(2);\r\n    let u3 = getUser(3);\r\n    let u4 = getUser(4);\r\n\r\n    // addTest(p1, { userImageUrl: p0.productImageUrl, userImageHandles: p0.productImageHandles });\r\n\r\n    addTest(p0, { userImageUrl: p1.productImageUrl, userImageHandles: p1.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p2.productImageUrl, userImageHandles: p2.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p3.productImageUrl, userImageHandles: p3.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p4.productImageUrl, userImageHandles: p4.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p5.productImageUrl, userImageHandles: p5.productImageHandles }, 1);\r\n\r\n    addTest(p0, u0);\r\n    addTest(p0, u1);\r\n    addTest(p0, u2);\r\n    addTest(p0, u3);\r\n    addTest(p0, u4);\r\n\r\n    addTest(p1, u0);\r\n    addTest(p1, u1);\r\n    addTest(p1, u2);\r\n    addTest(p1, u3);\r\n    addTest(p1, u4);\r\n\r\n    addTest(p2, u0);\r\n    addTest(p2, u1);\r\n    addTest(p2, u2);\r\n    addTest(p2, u3);\r\n    addTest(p2, u4);\r\n\r\n    addTest(p3, u0);\r\n    addTest(p3, u1);\r\n    addTest(p3, u2);\r\n    addTest(p3, u3);\r\n    addTest(p3, u4);\r\n\r\n    addTest(p4, u0);\r\n    addTest(p4, u1);\r\n    addTest(p4, u2);\r\n    addTest(p4, u3);\r\n    addTest(p4, u4);\r\n\r\n    addTest(p5, u0);\r\n    addTest(p5, u1);\r\n    addTest(p5, u2);\r\n    addTest(p5, u3);\r\n    addTest(p5, u4);\r\n\r\n    let productJsonObj = { ...p1.productImageHandles };\r\n    delete ((productJsonObj as any)['center']);\r\n    console.log('product json', JSON.stringify(productJsonObj));\r\n\r\n    let userJsonObj = { ...u0.userImageHandles };\r\n    console.log('user json', JSON.stringify(userJsonObj));\r\n\r\n    console.log('test END');\r\n}\r\n\r\nfunction addTest(product: any, user: any, moveHandleRadius = 0.25, shouldMoveProductHandles = false) {\r\n    let host = document.createElement('div');\r\n    document.body.appendChild(host);\r\n    host.style.width = '300px';\r\n    host.style.height = '300px';\r\n    host.style.display = 'inline-block';\r\n\r\n    S.setupUserFitting({\r\n        host: host,\r\n        userImageUrl: user.userImageUrl,\r\n        userImageHandles: user.userImageHandles,\r\n        productImageUrl: product.productImageUrl,\r\n        productImageHandles: product.productImageHandles,\r\n        // shouldMoveProductHandles,\r\n        moveHandleRadius\r\n    });\r\n}\r\n\r\n\r\nfunction getProduct(i: number) {\r\n    if (i === 0) {\r\n        return {\r\n            productImageUrl: '/sizeGuide.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 25 / 300, y: 60 / 150, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 275 / 300, y: 60 / 150, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 1) {\r\n        return {\r\n            productImageUrl: '/productImageB01.png',\r\n            productImageHandles: {\r\n                // left_temple: { x: 295 / 1936, y: 300 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                // right_temple: { x: 1667 / 1936, y: 300 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                left_temple: { x: 295 / 1936, y: 252 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 1667 / 1936, y: 248 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 2) {\r\n        return {\r\n            productImageUrl: '/productImageB02.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 58 / 600, y: 220 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 228 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 3) {\r\n        return {\r\n            productImageUrl: '/productImageB03.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 48 / 600, y: 223 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 231 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 4) {\r\n        return {\r\n            productImageUrl: '/productImageB04.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 58 / 600, y: 213 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 221 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 5) {\r\n        return {\r\n            productImageUrl: '/productImageB05.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 50 / 600, y: 220 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 542 / 600, y: 224 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    }\r\n}\r\n\r\n\r\nfunction getUser(i: number) {\r\n    if (i === 0) {\r\n        return {\r\n            userImageUrl: '/userImage02.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 184 / 600, y: 230 / 600 },\r\n                right_temple: { x: 393 / 600, y: 199 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 1) {\r\n        return {\r\n            userImageUrl: '/userModelWoman_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 222 / 600, y: 241 / 600 },\r\n                right_temple: { x: 401 / 600, y: 246 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 2) {\r\n        return {\r\n            userImageUrl: '/userModelMan_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 200 / 600, y: 223 / 600 },\r\n                right_temple: { x: 413 / 600, y: 224 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 3) {\r\n        return {\r\n            userImageUrl: '/userModelChild_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 206 / 600, y: 270 / 600 },\r\n                right_temple: { x: 426 / 600, y: 267 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 4) {\r\n        return {\r\n            userImageUrl: '/userImage03.png',\r\n            userImageHandles: {\r\n                left_temple: { x: 268 / 600, y: 316 / 600 },\r\n                right_temple: { x: 438 / 600, y: 227 / 600 },\r\n            },\r\n        };\r\n    }\r\n}\r\n\r\n// function getUser(i: number) {\r\n//     if (i === 0) {\r\n//         return {\r\n//             userImageUrl: '/userImage00.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 168 / 600, y: 260 / 600 },\r\n//                 right_temple: { x: 438 / 600, y: 260 / 600 },\r\n//                 left_earpiece: { x: 145 / 600, y: 278 / 600 },\r\n//                 right_earpiece: { x: 460 / 600, y: 292 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 1) {\r\n//         return {\r\n//             userImageUrl: '/userImage01.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 62 / 220, y: 78 / 215 },\r\n//                 right_temple: { x: 135 / 220, y: 78 / 215 },\r\n//                 left_earpiece: { x: 59 / 220, y: 83 / 215 },\r\n//                 right_earpiece: { x: 138 / 220, y: 78 / 215 },\r\n//             },\r\n//         };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             userImageUrl: '/userImage02.jpg',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 184 / 600, y: 230 / 600 },\r\n//                 right_temple: { x: 393 / 600, y: 199 / 600 },\r\n//                 // left_temple: { x: 185 / 600, y: 235 / 600 },\r\n//                 // right_temple: { x: 394 / 600, y: 204 / 600 },\r\n//                 left_earpiece: { x: 150 / 600, y: 255 / 600 },\r\n//                 right_earpiece: { x: 425 / 600, y: 205 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             userImageUrl: '/userImage03.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 243 / 600, y: 316 / 600 },\r\n//                 right_temple: { x: 452 / 600, y: 207 / 600 },\r\n//                 left_earpiece: { x: 161 / 600, y: 282 / 600 },\r\n//                 right_earpiece: { x: 413 / 600, y: 186 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\n// function getProduct(i: number) {\r\n//     if (i === 1) {\r\n//         return {\r\n//             productImageUrl: '/productImageB01.png',\r\n//             productImageHandles: {\r\n//                 left_temple: { x: 0.1, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 0.9, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//             },\r\n//         };\r\n//         // return {\r\n//         //     productImageUrl: '/sampleCutout.png',\r\n//         //     productImageHandles: {\r\n//         //         // center: { x: 670 / 1348, y: 129 / 462, kind: S.ImageHandleKind.Anchor },\r\n//         //         // left_temple: { x: 35 / 1348, y: 121 / 462, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         // right_temple: { x: 1296 / 1348, y: 114 / 462, kind: S.ImageHandleKind.RotateAndScale },\r\n\r\n//         //         // center: { x: 0.5, y: 0.1, kind: S.ImageHandleKind.Anchor },\r\n//         //         left_temple: { x: 0.1, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         right_temple: { x: 0.9, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //     },\r\n//         // };\r\n//         // return {\r\n//         //     productImageUrl: '/productImage01.png',\r\n//         //     productImageHandles: {\r\n//         //         center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//         //         left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//         //         right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//         //     },\r\n//         // };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             productImageUrl: '/productImage02.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 3) {\r\n//         return {\r\n//             productImageUrl: '/productImage03.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 4) {\r\n//         return {\r\n//             productImageUrl: '/productImage04.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 5) {\r\n//         return {\r\n//             productImageUrl: '/productImage05.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             productImageUrl: '/productImage.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 300 / 600, y: 254 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 246 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 544 / 600, y: 248 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 18 / 600, y: 280 / 600 },\r\n//                 right_earpiece: { x: 583 / 600, y: 304 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\n// function getUser(i: number) {\r\n//     if (i === 0) {\r\n//         return {\r\n//             userImageUrl: '/userImage00.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 168 / 600, y: 260 / 600 },\r\n//                 right_temple: { x: 438 / 600, y: 260 / 600 },\r\n//                 left_earpiece: { x: 145 / 600, y: 278 / 600 },\r\n//                 right_earpiece: { x: 460 / 600, y: 292 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 1) {\r\n//         return {\r\n//             userImageUrl: '/userImage01.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 62 / 220, y: 78 / 215 },\r\n//                 right_temple: { x: 135 / 220, y: 78 / 215 },\r\n//                 left_earpiece: { x: 59 / 220, y: 83 / 215 },\r\n//                 right_earpiece: { x: 138 / 220, y: 78 / 215 },\r\n//             },\r\n//         };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             userImageUrl: '/userImage02.jpg',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 170 / 600, y: 217 / 600 },\r\n//                 right_temple: { x: 406 / 600, y: 184 / 600 },\r\n//                 left_earpiece: { x: 150 / 600, y: 255 / 600 },\r\n//                 right_earpiece: { x: 425 / 600, y: 205 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             userImageUrl: '/userImage03.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 243 / 600, y: 316 / 600 },\r\n//                 right_temple: { x: 452 / 600, y: 207 / 600 },\r\n//                 left_earpiece: { x: 161 / 600, y: 282 / 600 },\r\n//                 right_earpiece: { x: 413 / 600, y: 186 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\ntest();\n\n\n// WEBPACK FOOTER //\n// ./test/test.ts","export * from './user-fitting-simple';\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import { DrawingContext, DrawingBuffer } from './drawing-buffer';\r\nimport { drawImagesAligned, RelativePosition, RelativePoint, ImagePosition, getDistance, drawPoint } from './draw-images-aligned';\r\n\r\nconst DEBUG_DETAILS = false;\r\nconst DEBUG_LOG = true;\r\n\r\nexport enum ImageHandleKind {\r\n    Stretch,\r\n    RotateAndScale,\r\n    Anchor,\r\n}\r\nexport interface ImageHandle {\r\n    x: number;\r\n    y: number;\r\n    x_start?: number;\r\n    y_start?: number;\r\n    nearestTouch?: number;\r\n    kind?: ImageHandleKind;\r\n}\r\nexport interface ImageHandles {\r\n    // [key: string]: ImageHandle;\r\n    left_temple: ImageHandle;\r\n    right_temple: ImageHandle;\r\n}\r\n\r\nexport interface UserFittingOptions {\r\n    host: HTMLDivElement;\r\n    userImageUrl: string;\r\n    userImageHandles: ImageHandles;\r\n    productImageUrl: string;\r\n    productImageHandles: ImageHandles;\r\n    moveHandleRadius?: number;\r\n    isReadonly?: boolean;\r\n    onMove?: () => void;\r\n}\r\n\r\nlet _nextId = 0;\r\n\r\nexport function setupUserFitting(options: UserFittingOptions) {\r\n    let c = new DrawingBuffer(options.host.clientWidth || 600, options.host.clientHeight || 600);\r\n\r\n    const id = _nextId++;\r\n    function log(...args: any[]) {\r\n        if (!DEBUG_LOG) { return; }\r\n        console.log(`[${id}]`, ...args);\r\n    };\r\n\r\n    const divContainer = document.createElement('div');\r\n    divContainer.style.position = 'relative';\r\n    divContainer.appendChild(c.canvas);\r\n\r\n    options.host.appendChild(divContainer);\r\n    c.canvas.style.width = '100%';\r\n\r\n    let divLoading = document.createElement('div');\r\n    divLoading.style.position = 'absolute';\r\n    divLoading.style.left = '0';\r\n    divLoading.style.right = '0';\r\n    divLoading.style.top = '0';\r\n    divLoading.style.bottom = '0';\r\n    divLoading.style.backgroundColor = '#000000';\r\n    divLoading.style.opacity = '0.2';\r\n\r\n    divContainer.appendChild(divLoading);\r\n\r\n    const removeIsLoading = () => {\r\n        if (!divLoading) { return; }\r\n        divContainer.removeChild(divLoading);\r\n        divLoading = null;\r\n        log('removeIsLoading');\r\n    };\r\n\r\n    // Load Images\r\n    let isUserImageLoaded = false;\r\n    let isProductImageLoaded = false;\r\n\r\n    const userImage = new Image();\r\n    userImage.onload = () => {\r\n        isUserImageLoaded = true;\r\n        refresh();\r\n    };\r\n    userImage.src = options.userImageUrl;\r\n    // isUserImageLoaded = userImage.width > 0;\r\n\r\n    const productImage = new Image();\r\n    productImage.onload = () => {\r\n        isProductImageLoaded = true;\r\n        refresh();\r\n    };\r\n    productImage.src = options.productImageUrl;\r\n    // isProductImageLoaded = productImage.width > 0;\r\n\r\n    // Input Vars\r\n    let shouldDrawHandles = false;\r\n    let lastActualScale = 1;\r\n\r\n    // Draw\r\n    let refreshTimeoutId = 0;\r\n    const refresh = () => {\r\n        // if (!userImage.width || !productImage.width) {\r\n        if (!isUserImageLoaded || !isProductImageLoaded) {\r\n            clearTimeout(refreshTimeoutId);\r\n            refreshTimeoutId = setTimeout(refresh, 250);\r\n            return;\r\n        }\r\n\r\n        log('refresh', userImage.width, productImage.width);\r\n\r\n        c.context.clearRect(0, 0, options.host.clientWidth, options.host.clientHeight);\r\n        const actual = drawImagesAligned(c, [toSimpleImageInfo(userImage, options.userImageHandles), toSimpleImageInfo(productImage, options.productImageHandles)], shouldDrawHandles);\r\n        lastActualScale = actual.actualScale;\r\n\r\n        if (isUserImageLoaded && isProductImageLoaded) {\r\n            setTimeout(() => {\r\n                removeIsLoading();\r\n                setupUserInput();\r\n            }, 0);\r\n        } else {\r\n            clearTimeout(refreshTimeoutId);\r\n            refreshTimeoutId = setTimeout(refresh, 250);\r\n        }\r\n        return actual.actualPosition;\r\n    };\r\n\r\n    refresh();\r\n\r\n    // Handle User Input\r\n    const setupUserInput = () => {\r\n        if (!options.isReadonly) {\r\n            handleUserInput(c, log, (drawHandles, positionChange) => {\r\n                shouldDrawHandles = drawHandles;\r\n\r\n                log('positionChange', positionChange, lastActualScale, userImage.width, c.width, userImage.height, c.height);\r\n\r\n                if (!positionChange) {\r\n                    options.userImageHandles.left_temple.x_start = options.userImageHandles.left_temple.x;\r\n                    options.userImageHandles.left_temple.y_start = options.userImageHandles.left_temple.y;\r\n                    options.userImageHandles.right_temple.x_start = options.userImageHandles.right_temple.x;\r\n                    options.userImageHandles.right_temple.y_start = options.userImageHandles.right_temple.y;\r\n                } else {\r\n\r\n                    options.userImageHandles.left_temple.x = options.userImageHandles.left_temple.x_start + positionChange.a.u; // * (userImage.width / c.width);\r\n                    options.userImageHandles.left_temple.y = options.userImageHandles.left_temple.y_start + positionChange.a.v * (userImage.width / userImage.height); // * (userImage.height / c.height);\r\n                    options.userImageHandles.right_temple.x = options.userImageHandles.right_temple.x_start + positionChange.b.u; // * (userImage.width / c.width);\r\n                    options.userImageHandles.right_temple.y = options.userImageHandles.right_temple.y_start + positionChange.b.v * (userImage.width / userImage.height); // * (userImage.height / c.height);\r\n                }\r\n\r\n                const result = refresh();\r\n\r\n                if (DEBUG_DETAILS && positionChange) {\r\n                    drawPoint(c, { u: 0.5 + positionChange.a.u, v: 0.5 + positionChange.a.v }, '#0000FF');\r\n                    drawPoint(c, { u: 0.5 + positionChange.b.u, v: 0.5 + positionChange.b.v }, '#0000FF');\r\n                }\r\n\r\n                if (options.onMove) {\r\n                    options.onMove();\r\n                }\r\n\r\n                return result;\r\n            });\r\n        }\r\n    };\r\n\r\n    return {\r\n        refresh\r\n    };\r\n}\r\n\r\n\r\nfunction toSimpleImageInfo(image: HTMLImageElement | HTMLCanvasElement, imageHandles: ImageHandles): ImagePosition {\r\n    const aHandle = imageHandles.left_temple;\r\n    const bHandle = imageHandles.right_temple;\r\n\r\n    return {\r\n        image,\r\n        a: { u: aHandle.x, v: aHandle.y },\r\n        b: { u: bHandle.x, v: bHandle.y },\r\n    };\r\n}\r\n\r\n\r\nfunction handleUserInput(c: DrawingContext, log: (...args: any[]) => void, onChange: (shouldDrawHandles: boolean, positionChange: RelativePosition) => RelativePosition) {\r\n\r\n    const MOVEMENT_RATIO = 0.5;\r\n\r\n    const MAX_DRAG_RATIO = 0.25;\r\n    const TIME_REMOVE_HANDLES = 3000;\r\n\r\n    let lastActualPosition: RelativePosition = null;\r\n    let isDraggingWhole = false;\r\n    let isDraggingPoint = false;\r\n\r\n    let start: PointInfo = null;\r\n    let startPosition: RelativePosition = null;\r\n    let shouldDrawHandles = false;\r\n\r\n    let removeHandlesTimeoutId: number = null;\r\n\r\n    const dragStart = (e: MouseEvent | TouchEvent) => {\r\n        log('dragStart');\r\n\r\n        if (!lastActualPosition) { lastActualPosition = onChange(shouldDrawHandles, null); }\r\n        if (!lastActualPosition) { return; }\r\n\r\n        startPosition = lastActualPosition;\r\n        start = getPointInfo(e, c, [startPosition.a, startPosition.b]);\r\n        shouldDrawHandles = true;\r\n\r\n        // log('dragStart', e, lastActual, start);\r\n\r\n        const nearest = start.nearest;\r\n        if (!nearest) { return; }\r\n\r\n        subscribe();\r\n\r\n        const distance = getDistance(lastActualPosition);\r\n        const maxMoveWholeDistanceSq = distance * distance;\r\n        const maxMovePointDistanceSq = maxMoveWholeDistanceSq * MAX_DRAG_RATIO * MAX_DRAG_RATIO;\r\n\r\n        if (nearest.distanceSq < maxMovePointDistanceSq) {\r\n            isDraggingPoint = true;\r\n        } else if (nearest.distanceSq < maxMoveWholeDistanceSq) {\r\n            isDraggingWhole = true;\r\n        }\r\n\r\n        if (DEBUG_DETAILS) {\r\n            setTimeout(() => {\r\n                log('dragStart distance', distance);\r\n                drawPoint(c, start, '#FF0000', c.width * Math.sqrt(nearest.distanceSq));\r\n                drawPoint(c, start, '#FFFF00', c.width * Math.sqrt(maxMovePointDistanceSq));\r\n                drawPoint(c, start, '#FF00FF', c.width * Math.sqrt(maxMoveWholeDistanceSq));\r\n            }, 10);\r\n\r\n            log('dragStart', isDraggingPoint, isDraggingWhole, nearest.distanceSq, maxMovePointDistanceSq, maxMoveWholeDistanceSq, e, lastActualPosition, start);\r\n        }\r\n\r\n        onChange(shouldDrawHandles, null);\r\n    };\r\n\r\n    const dragEnd = () => {\r\n        log('dragEnd');\r\n\r\n        unsubscribe();\r\n        isDraggingPoint = isDraggingWhole = false;\r\n    };\r\n\r\n    const dragMove = (e: MouseEvent | TouchEvent) => {\r\n        log('dragMove');\r\n\r\n        if (!isDraggingPoint && !isDraggingWhole) { return; }\r\n\r\n        shouldDrawHandles = true;\r\n\r\n        // Move the nearest point\r\n        let {u, v, u2, v2, nearest} = getPointInfo(e, c, [lastActualPosition.a, lastActualPosition.b]);\r\n\r\n        const startPoint = start.nearest.index === 0 ? startPosition.a : startPosition.b;\r\n        const newPoint = { u: 0, v: 0 };\r\n        newPoint.u = (u - start.u) * MOVEMENT_RATIO;\r\n        newPoint.v = (v - start.v) * MOVEMENT_RATIO;\r\n\r\n        const newPoint2 = { u: 0, v: 0 };\r\n        newPoint2.u = (u2 - start.u2) * MOVEMENT_RATIO;\r\n        newPoint2.v = (v2 - start.v2) * MOVEMENT_RATIO;\r\n\r\n        const positionChange = { a: { u: 0, v: 0 }, b: { u: 0, v: 0 } };\r\n\r\n        if (isDraggingPoint) {\r\n            if (start.nearest.index === 0) {\r\n                positionChange.a = newPoint;\r\n                positionChange.b = newPoint2;\r\n            } else {\r\n                positionChange.b = newPoint;\r\n                positionChange.a = newPoint2;\r\n            }\r\n        } else if (isDraggingWhole) {\r\n            positionChange.a = newPoint;\r\n            positionChange.b = newPoint;\r\n        }\r\n\r\n        lastActualPosition = onChange(shouldDrawHandles, positionChange);\r\n\r\n\r\n        let removeHandles = () => {\r\n            clearTimeout(removeHandlesTimeoutId);\r\n            removeHandlesTimeoutId = setTimeout(() => {\r\n                if (isDraggingPoint) { removeHandles(); return; }\r\n                shouldDrawHandles = false;\r\n                onChange(shouldDrawHandles, null);\r\n            }, TIME_REMOVE_HANDLES);\r\n        };\r\n\r\n        removeHandles();\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n        return false;\r\n    };\r\n\r\n    c.canvas.addEventListener('mousedown', dragStart);\r\n    c.canvas.addEventListener('touchstart', dragStart);\r\n    c.canvas.addEventListener('touchend', dragEnd);\r\n    c.canvas.addEventListener('touchmove', dragMove);\r\n\r\n    const subscribe = () => {\r\n        // log('subscribe');\r\n        document.addEventListener('mouseup', dragEnd);\r\n        document.addEventListener('mousemove', dragMove);\r\n    };\r\n\r\n    const unsubscribe = () => {\r\n        // log('unsubscribe');\r\n        document.removeEventListener('mouseup', dragEnd);\r\n        document.removeEventListener('mousemove', dragMove);\r\n    };\r\n}\r\n\r\nfunction getPointInfo(e: MouseEvent | TouchEvent, c: DrawingContext, points: RelativePoint[]) {\r\n\r\n    const cvs = c.canvas;\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    let rect = cvs.getBoundingClientRect();\r\n    let xm = 0;\r\n    let ym = 0;\r\n    let xm2 = null as number;\r\n    let ym2 = null as number;\r\n\r\n    const eMouse = e as MouseEvent;\r\n    const eTouch = e as TouchEvent;\r\n\r\n    if (eMouse.clientX != null) {\r\n        xm = eMouse.clientX - rect.left;\r\n        ym = eMouse.clientY - rect.top;\r\n    } else if (eTouch.touches != null) {\r\n        xm = eTouch.touches[0].clientX - rect.left;\r\n        ym = eTouch.touches[0].clientY - rect.top;\r\n\r\n        if (eTouch.touches[1]) {\r\n            xm2 = eTouch.touches[1].clientX - rect.left;\r\n            ym2 = eTouch.touches[1].clientY - rect.top;\r\n        }\r\n    }\r\n\r\n    let u = xm / w;\r\n    let v = ym / h;\r\n    let u2 = xm2 ? xm2 / w : null;\r\n    let v2 = ym2 ? ym2 / h : null;\r\n    let nearest = !points || !points.length ? null\r\n        : points.map((p, i) => ({ point: p, index: i, distanceSq: (p.u - u) * (p.u - u) + (p.v - v) * (p.v - v) })).sort((a, b) => a.distanceSq - b.distanceSq)[0];\r\n\r\n\r\n    // DEBUG\r\n    if (DEBUG_DETAILS) {\r\n        for (let p of points) {\r\n            drawPoint(c, p, '#FFFF00', 4);\r\n        }\r\n\r\n        drawPoint(c, { u, v }, '#FF00FF', 4);\r\n        if (u2) { drawPoint(c, { u: u2, v: v2 }, '#FF00FF', 4); }\r\n        drawPoint(c, nearest.point, '#FF0000', 4);\r\n    }\r\n\r\n    return { u, v, u2, v2, nearest };\r\n};\r\n\r\nlet tempPointInfo = (null as any) && getPointInfo(null, null, null);\r\ntype PointInfo = typeof tempPointInfo;\n\n\n// WEBPACK FOOTER //\n// ./src/user-fitting-simple.ts","const DEBUG = false;\r\n\r\nexport interface DrawingContext {\r\n    width: number;\r\n    height: number;\r\n    canvas: HTMLCanvasElement;\r\n    context: CanvasRenderingContext2D;\r\n}\r\n\r\nexport class DrawingBuffer implements DrawingContext {\r\n    canvas: HTMLCanvasElement;\r\n    context: CanvasRenderingContext2D;\r\n    width: number;\r\n    height: number;\r\n\r\n    constructor(width: number, height: number) {\r\n        this.canvas = document.createElement('canvas');\r\n        this.width = this.canvas.width = width;\r\n        this.height = this.canvas.height = height;\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        if (DEBUG) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n\r\n    clear(width: number, height: number) {\r\n        if (this.canvas.width !== width) {\r\n            this.width = this.canvas.width = width;\r\n            this.height = this.canvas.height = height;\r\n        }\r\n\r\n        this.context.clearRect(0, 0, width, height);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/drawing-buffer.ts","import { DrawingContext, DrawingBuffer } from './drawing-buffer';\r\nimport { drawWithEdgeBlur } from './draw-with-blur';\r\n\r\nexport interface RelativePoint {\r\n    u: number;\r\n    v: number;\r\n}\r\n\r\nexport interface RelativePosition {\r\n    a: RelativePoint;\r\n    b: RelativePoint;\r\n}\r\n\r\nexport interface ImagePosition extends RelativePosition {\r\n    image: HTMLImageElement | HTMLCanvasElement;\r\n}\r\n\r\nconst buffer = new DrawingBuffer(1200, 1200);\r\n\r\nexport function drawImagesAligned(cOrig: DrawingContext, images: ImagePosition[], shouldDrawPosition: boolean) {\r\n\r\n    // Anti-alias by drawing at a higher scale and resizing after merging\r\n    // const scale = 600 / cOrig.width;\r\n    const drawScale = 2;\r\n    const wBuffer = drawScale * cOrig.width;\r\n    const hBuffer = drawScale * cOrig.height;\r\n    buffer.clear(wBuffer, hBuffer);\r\n    const c = buffer;\r\n\r\n    // Draw the main image and get it's actual position\r\n    const mainImage = images[0];\r\n    const {mainPosition, mainScale} = drawImageCentered(c, mainImage);\r\n\r\n    // Draw each image\r\n    for (let i = 0; i < images.length; i++) {\r\n        if (i === 0) { continue; }\r\n\r\n        drawImageAligned(c, images[i], mainPosition);\r\n    }\r\n\r\n    if (shouldDrawPosition) { drawPosition(c, mainPosition); }\r\n\r\n    // Resize\r\n    cOrig.context.drawImage(buffer.canvas, 0, 0, wBuffer, hBuffer, 0, 0, cOrig.width, cOrig.height);\r\n\r\n    // const actualPosition = {\r\n    //     a: {\r\n    //         u: mainPosition.a.u / scale,\r\n    //         v: mainPosition.a.v / scale,\r\n    //     },\r\n    //     b: {\r\n    //         u: mainPosition.b.u / scale,\r\n    //         v: mainPosition.b.v / scale,\r\n    //     }\r\n    // };\r\n    const actualPosition = mainPosition;\r\n    return { actualPosition, actualScale: mainScale * drawScale };\r\n}\r\n\r\nfunction drawImageCentered(c: DrawingContext, image: ImagePosition) {\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const wImage = image.image.width;\r\n    const hImage = image.image.height;\r\n\r\n    const wScale = w / wImage;\r\n    const hScale = h / hImage;\r\n\r\n    // Fill\r\n    // const scale = Math.max(wScale, hScale);\r\n\r\n    // Fit Inside\r\n    const mainScale = Math.min(wScale, hScale);\r\n\r\n    // const scale = 1;\r\n\r\n    const x = 0.5 * (w - mainScale * wImage);\r\n    const y = 0.5 * (h - mainScale * hImage);\r\n\r\n    c.context.drawImage(image.image,\r\n        0, 0, wImage, hImage,\r\n        x, y, mainScale * wImage, mainScale * hImage\r\n    );\r\n\r\n    const mainPosition = {\r\n        a: {\r\n            u: (x + image.a.u * wImage * mainScale) / w,\r\n            v: (y + image.a.v * hImage * mainScale) / h,\r\n        },\r\n        b: {\r\n            u: (x + image.b.u * wImage * mainScale) / w,\r\n            v: (y + image.b.v * hImage * mainScale) / h,\r\n        },\r\n    };\r\n\r\n    return { mainPosition, mainScale };\r\n}\r\n\r\nexport function drawPosition(c: DrawingContext, position: RelativePosition) {\r\n    drawPoint(c, position.a);\r\n    drawPoint(c, position.b);\r\n}\r\n\r\nexport function drawPoint(c: DrawingContext, point: RelativePoint, color = '#00FF00', radius = 16) {\r\n    const ctx = c.context;\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const thickness = 2;\r\n\r\n    const u = point.u;\r\n    const v = point.v;\r\n\r\n    ctx.globalAlpha = 0.5;\r\n    ctx.lineWidth = thickness;\r\n    ctx.strokeStyle = color;\r\n\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(u * w - radius, v * h);\r\n    // ctx.lineTo(u * w + radius, v * h);\r\n    // ctx.stroke();\r\n\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(u * w, v * h - radius);\r\n    // ctx.lineTo(u * w, v * h + radius);\r\n    // ctx.stroke();\r\n\r\n    ctx.beginPath();\r\n    ctx.fillStyle = color;\r\n    ctx.arc(u * w, v * h, radius, 0, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n}\r\n\r\nfunction drawImageAligned(c: DrawingContext, image: ImagePosition, position: RelativePosition) {\r\n    const uAxis = (position.a.u + position.b.u) * 0.5;\r\n    const vAxis = (position.a.v + position.b.v) * 0.5;\r\n\r\n    const uAxis_image = (image.a.u + image.b.u) * 0.5;\r\n    const vAxis_image = (image.a.v + image.b.v) * 0.5;\r\n\r\n    const ctx = c.context;\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const wImage = image.image.width;\r\n    const hImage = image.image.height;\r\n\r\n\r\n    const posDistance = getDistance(position);\r\n    const imageDistance = getDistance(image);\r\n    const uvScale = posDistance / imageDistance;\r\n    const scale = uvScale * w / wImage;\r\n\r\n    // console.log('distance', posDistance, imageDistance, scale, w, h, wImage, hImage);\r\n\r\n    const posAngle = getAngle(position);\r\n    const imageAngle = getAngle(image);\r\n    const angle = posAngle - imageAngle;\r\n\r\n    const xAxis = w * uAxis;\r\n    const yAxis = h * vAxis;\r\n\r\n    const xImage = xAxis - uAxis_image * scale * wImage;\r\n    const yImage = yAxis - vAxis_image * scale * hImage;\r\n\r\n    ctx.save();\r\n\r\n    ctx.translate(uAxis * w, vAxis * h);\r\n    ctx.rotate(angle);\r\n    ctx.translate(-uAxis * w, -vAxis * h);\r\n\r\n    // ctx.drawImage(image.image,\r\n    //     0, 0, wImage, hImage,\r\n    //     xImage, yImage, scale * wImage, scale * hImage\r\n    // );\r\n\r\n    drawWithEdgeBlur(ctx, w, h, ctx2 => {\r\n        ctx2.drawImage(image.image,\r\n            0, 0, wImage, hImage,\r\n            xImage, yImage, scale * wImage, scale * hImage\r\n        );\r\n    });\r\n\r\n    ctx.restore();\r\n\r\n}\r\n\r\nexport function getDistance(position: RelativePosition): number {\r\n    const uDelta = position.a.u - position.b.u;\r\n    const vDelta = position.a.v - position.b.v;\r\n    return Math.sqrt(uDelta * uDelta + vDelta * vDelta);\r\n}\r\n\r\nfunction getAngle(position: RelativePosition): number {\r\n    const uDelta = position.a.u - position.b.u;\r\n    const vDelta = position.a.v - position.b.v;\r\n    return Math.atan(vDelta / uDelta);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/draw-images-aligned.ts","import { DrawingBuffer } from './drawing-buffer';\r\n\r\nlet drawBuffer: DrawingBuffer;\r\nlet blurBuffer: DrawingBuffer;\r\nlet mergeBuffer: DrawingBuffer;\r\n\r\n// Draw edge blur by downsampling image to half size, drawing that first and then drawing sharp image on top\r\nexport function drawWithEdgeBlur(ctx: CanvasRenderingContext2D, width: number, height: number, draw: (ctx: CanvasRenderingContext2D) => void) {\r\n\r\n    let downsample_ratio = 0.5;\r\n    let downsample_alpha = 0.5;\r\n\r\n    if (drawBuffer == null) { drawBuffer = new DrawingBuffer(width, height); }\r\n    drawBuffer.clear(width, height);\r\n\r\n    if (blurBuffer == null) { blurBuffer = new DrawingBuffer(width * downsample_ratio, height * downsample_ratio); }\r\n    blurBuffer.clear(width * downsample_ratio, height * downsample_ratio);\r\n\r\n    if (mergeBuffer == null) { mergeBuffer = new DrawingBuffer(width, height); }\r\n    mergeBuffer.clear(width, height);\r\n\r\n    draw(drawBuffer.context);\r\n    blurBuffer.context.drawImage(drawBuffer.canvas, 0, 0, width, height, 0, 0, width * downsample_ratio, height * downsample_ratio);\r\n    mergeBuffer.context.globalAlpha = downsample_alpha;\r\n    mergeBuffer.context.drawImage(blurBuffer.canvas, 0, 0, width * downsample_ratio, height * downsample_ratio, 0, 0, width, height);\r\n    mergeBuffer.context.globalAlpha = 1;\r\n    mergeBuffer.context.drawImage(drawBuffer.canvas, 0, 0, width, height, 0, 0, width, height);\r\n    ctx.drawImage(mergeBuffer.canvas, 0, 0, width, height, 0, 0, width, height);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/draw-with-blur.ts"],"sourceRoot":""}