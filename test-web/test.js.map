{"version":3,"sources":["webpack:///webpack/bootstrap 035537af36664ed1af5d","webpack:///./test/test.ts","webpack:///./src/index.ts","webpack:///./src/user-fitting.ts","webpack:///./src/draw-quad.ts","webpack:///./src/draw-with-blur.ts","webpack:///./src/drawing-buffer.ts","webpack:///./src/draw-images-aligned.ts"],"names":[],"mappings":"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","file":"./test-web/test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 035537af36664ed1af5d","import * as S from '../src';\r\n\r\nexport function test() {\r\n    console.log('test START');\r\n\r\n    let p0 = getProduct(0);\r\n    let p1 = getProduct(1);\r\n    let p2 = getProduct(2);\r\n    let p3 = getProduct(3);\r\n    let p4 = getProduct(4);\r\n    let p5 = getProduct(5);\r\n    let u0 = getUser(0);\r\n    let u1 = getUser(1);\r\n    let u2 = getUser(2);\r\n    let u3 = getUser(3);\r\n    let u4 = getUser(4);\r\n\r\n    // addTest(p1, { userImageUrl: p0.productImageUrl, userImageHandles: p0.productImageHandles });\r\n\r\n    addTest(p0, { userImageUrl: p1.productImageUrl, userImageHandles: p1.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p2.productImageUrl, userImageHandles: p2.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p3.productImageUrl, userImageHandles: p3.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p4.productImageUrl, userImageHandles: p4.productImageHandles }, 1);\r\n    addTest(p0, { userImageUrl: p5.productImageUrl, userImageHandles: p5.productImageHandles }, 1);\r\n\r\n    addTest(p0, u0);\r\n    addTest(p0, u1);\r\n    addTest(p0, u2);\r\n    addTest(p0, u3);\r\n    addTest(p0, u4);\r\n\r\n    addTest(p1, u0);\r\n    addTest(p1, u1);\r\n    addTest(p1, u2);\r\n    addTest(p1, u3);\r\n    addTest(p1, u4);\r\n\r\n    addTest(p2, u0);\r\n    addTest(p2, u1);\r\n    addTest(p2, u2);\r\n    addTest(p2, u3);\r\n    addTest(p2, u4);\r\n\r\n    addTest(p3, u0);\r\n    addTest(p3, u1);\r\n    addTest(p3, u2);\r\n    addTest(p3, u3);\r\n    addTest(p3, u4);\r\n\r\n    addTest(p4, u0);\r\n    addTest(p4, u1);\r\n    addTest(p4, u2);\r\n    addTest(p4, u3);\r\n    addTest(p4, u4);\r\n\r\n    addTest(p5, u0);\r\n    addTest(p5, u1);\r\n    addTest(p5, u2);\r\n    addTest(p5, u3);\r\n    addTest(p5, u4);\r\n\r\n    let productJsonObj = { ...p1.productImageHandles };\r\n    delete ((productJsonObj as any)['center']);\r\n    console.log('product json', JSON.stringify(productJsonObj));\r\n\r\n    let userJsonObj = { ...u0.userImageHandles };\r\n    console.log('user json', JSON.stringify(userJsonObj));\r\n\r\n    console.log('test END');\r\n}\r\n\r\nfunction addTest(product: any, user: any, moveHandleRadius = 0.25, shouldMoveProductHandles = false) {\r\n    let host = document.createElement('div');\r\n    document.body.appendChild(host);\r\n    host.style.width = '300px';\r\n    host.style.height = '300px';\r\n    host.style.display = 'inline-block';\r\n\r\n    S.setupUserFitting({\r\n        host: host,\r\n        userImageUrl: user.userImageUrl,\r\n        userImageHandles: user.userImageHandles,\r\n        productImageUrl: product.productImageUrl,\r\n        productImageHandles: product.productImageHandles,\r\n        shouldMoveProductHandles,\r\n        moveHandleRadius\r\n    });\r\n}\r\n\r\n\r\nfunction getProduct(i: number) {\r\n    if (i === 0) {\r\n        return {\r\n            productImageUrl: '/sizeGuide.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 25 / 300, y: 60 / 150, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 275 / 300, y: 60 / 150, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 1) {\r\n        return {\r\n            productImageUrl: '/productImageB01.png',\r\n            productImageHandles: {\r\n                // left_temple: { x: 295 / 1936, y: 300 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                // right_temple: { x: 1667 / 1936, y: 300 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                left_temple: { x: 295 / 1936, y: 252 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 1667 / 1936, y: 248 / 685, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 2) {\r\n        return {\r\n            productImageUrl: '/productImageB02.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 58 / 600, y: 220 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 228 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 3) {\r\n        return {\r\n            productImageUrl: '/productImageB03.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 48 / 600, y: 223 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 231 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 4) {\r\n        return {\r\n            productImageUrl: '/productImageB04.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 58 / 600, y: 213 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 546 / 600, y: 221 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    } else if (i === 5) {\r\n        return {\r\n            productImageUrl: '/productImageB05.png',\r\n            productImageHandles: {\r\n                left_temple: { x: 50 / 600, y: 220 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n                right_temple: { x: 542 / 600, y: 224 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n            },\r\n        };\r\n    }\r\n}\r\n\r\n\r\nfunction getUser(i: number) {\r\n    if (i === 0) {\r\n        return {\r\n            userImageUrl: '/userImage02.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 184 / 600, y: 230 / 600 },\r\n                right_temple: { x: 393 / 600, y: 199 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 1) {\r\n        return {\r\n            userImageUrl: '/userModelWoman_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 222 / 600, y: 241 / 600 },\r\n                right_temple: { x: 401 / 600, y: 246 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 2) {\r\n        return {\r\n            userImageUrl: '/userModelMan_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 200 / 600, y: 223 / 600 },\r\n                right_temple: { x: 413 / 600, y: 224 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 3) {\r\n        return {\r\n            userImageUrl: '/userModelChild_600sq.jpg',\r\n            userImageHandles: {\r\n                left_temple: { x: 206 / 600, y: 270 / 600 },\r\n                right_temple: { x: 426 / 600, y: 267 / 600 },\r\n            },\r\n        };\r\n    } else if (i === 4) {\r\n        return {\r\n            userImageUrl: '/userImage03.png',\r\n            userImageHandles: {\r\n                left_temple: { x: 268 / 600, y: 316 / 600 },\r\n                right_temple: { x: 438 / 600, y: 227 / 600 },\r\n            },\r\n        };\r\n    }\r\n}\r\n\r\n// function getUser(i: number) {\r\n//     if (i === 0) {\r\n//         return {\r\n//             userImageUrl: '/userImage00.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 168 / 600, y: 260 / 600 },\r\n//                 right_temple: { x: 438 / 600, y: 260 / 600 },\r\n//                 left_earpiece: { x: 145 / 600, y: 278 / 600 },\r\n//                 right_earpiece: { x: 460 / 600, y: 292 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 1) {\r\n//         return {\r\n//             userImageUrl: '/userImage01.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 62 / 220, y: 78 / 215 },\r\n//                 right_temple: { x: 135 / 220, y: 78 / 215 },\r\n//                 left_earpiece: { x: 59 / 220, y: 83 / 215 },\r\n//                 right_earpiece: { x: 138 / 220, y: 78 / 215 },\r\n//             },\r\n//         };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             userImageUrl: '/userImage02.jpg',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 184 / 600, y: 230 / 600 },\r\n//                 right_temple: { x: 393 / 600, y: 199 / 600 },\r\n//                 // left_temple: { x: 185 / 600, y: 235 / 600 },\r\n//                 // right_temple: { x: 394 / 600, y: 204 / 600 },\r\n//                 left_earpiece: { x: 150 / 600, y: 255 / 600 },\r\n//                 right_earpiece: { x: 425 / 600, y: 205 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             userImageUrl: '/userImage03.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 243 / 600, y: 316 / 600 },\r\n//                 right_temple: { x: 452 / 600, y: 207 / 600 },\r\n//                 left_earpiece: { x: 161 / 600, y: 282 / 600 },\r\n//                 right_earpiece: { x: 413 / 600, y: 186 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\n// function getProduct(i: number) {\r\n//     if (i === 1) {\r\n//         return {\r\n//             productImageUrl: '/productImageB01.png',\r\n//             productImageHandles: {\r\n//                 left_temple: { x: 0.1, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 0.9, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//             },\r\n//         };\r\n//         // return {\r\n//         //     productImageUrl: '/sampleCutout.png',\r\n//         //     productImageHandles: {\r\n//         //         // center: { x: 670 / 1348, y: 129 / 462, kind: S.ImageHandleKind.Anchor },\r\n//         //         // left_temple: { x: 35 / 1348, y: 121 / 462, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         // right_temple: { x: 1296 / 1348, y: 114 / 462, kind: S.ImageHandleKind.RotateAndScale },\r\n\r\n//         //         // center: { x: 0.5, y: 0.1, kind: S.ImageHandleKind.Anchor },\r\n//         //         left_temple: { x: 0.1, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         right_temple: { x: 0.9, y: 0.1, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //     },\r\n//         // };\r\n//         // return {\r\n//         //     productImageUrl: '/productImage01.png',\r\n//         //     productImageHandles: {\r\n//         //         center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//         //         left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//         //         left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//         //         right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//         //     },\r\n//         // };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             productImageUrl: '/productImage02.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 3) {\r\n//         return {\r\n//             productImageUrl: '/productImage03.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 4) {\r\n//         return {\r\n//             productImageUrl: '/productImage04.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 5) {\r\n//         return {\r\n//             productImageUrl: '/productImage05.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 296 / 600, y: 267 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 243 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 546 / 600, y: 251 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 10 / 600, y: 286 / 600 },\r\n//                 right_earpiece: { x: 595 / 600, y: 294 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             productImageUrl: '/productImage.png',\r\n//             productImageHandles: {\r\n//                 center: { x: 300 / 600, y: 254 / 600, kind: S.ImageHandleKind.Anchor },\r\n//                 left_temple: { x: 58 / 600, y: 246 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 right_temple: { x: 544 / 600, y: 248 / 600, kind: S.ImageHandleKind.RotateAndScale },\r\n//                 left_earpiece: { x: 18 / 600, y: 280 / 600 },\r\n//                 right_earpiece: { x: 583 / 600, y: 304 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\n// function getUser(i: number) {\r\n//     if (i === 0) {\r\n//         return {\r\n//             userImageUrl: '/userImage00.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 168 / 600, y: 260 / 600 },\r\n//                 right_temple: { x: 438 / 600, y: 260 / 600 },\r\n//                 left_earpiece: { x: 145 / 600, y: 278 / 600 },\r\n//                 right_earpiece: { x: 460 / 600, y: 292 / 600 },\r\n//             },\r\n//         };\r\n//     } else if (i === 1) {\r\n//         return {\r\n//             userImageUrl: '/userImage01.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 62 / 220, y: 78 / 215 },\r\n//                 right_temple: { x: 135 / 220, y: 78 / 215 },\r\n//                 left_earpiece: { x: 59 / 220, y: 83 / 215 },\r\n//                 right_earpiece: { x: 138 / 220, y: 78 / 215 },\r\n//             },\r\n//         };\r\n//     } else if (i === 2) {\r\n//         return {\r\n//             userImageUrl: '/userImage02.jpg',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 170 / 600, y: 217 / 600 },\r\n//                 right_temple: { x: 406 / 600, y: 184 / 600 },\r\n//                 left_earpiece: { x: 150 / 600, y: 255 / 600 },\r\n//                 right_earpiece: { x: 425 / 600, y: 205 / 600 },\r\n//             },\r\n//         };\r\n//     } else {\r\n//         return {\r\n//             userImageUrl: '/userImage03.png',\r\n//             userImageHandles: {\r\n//                 left_temple: { x: 243 / 600, y: 316 / 600 },\r\n//                 right_temple: { x: 452 / 600, y: 207 / 600 },\r\n//                 left_earpiece: { x: 161 / 600, y: 282 / 600 },\r\n//                 right_earpiece: { x: 413 / 600, y: 186 / 600 },\r\n//             },\r\n//         };\r\n//     }\r\n// }\r\n\r\ntest();\n\n\n// WEBPACK FOOTER //\n// ./test/test.ts","export * from './user-fitting';\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import { drawTriangle } from './draw-triangle';\r\nimport { drawQuad } from './draw-quad';\r\nimport { drawWithEdgeBlur } from './draw-with-blur';\r\nimport { drawWithShade } from './draw-with-shade';\r\nimport { DrawingBuffer, DrawingContext } from './drawing-buffer';\r\nimport { drawImagesAligned, RelativePosition, ImagePosition } from './draw-images-aligned';\r\n\r\nconst DEBUG = false;\r\nconst DEBUG_MOUSE = false;\r\n\r\nconst HANDLE_RADIUS = 0.1;\r\nconst DEFAULT_MOVE_HANDLE_RADIUS = 0.25;\r\nconst MAX_DRAG_DISTANCE_SQ = HANDLE_RADIUS * HANDLE_RADIUS;\r\n// const MAX_MOVE_DISTANCE_SQ = DEFAULT_MOVE_HANDLE_RADIUS * DEFAULT_MOVE_HANDLE_RADIUS;\r\nconst TIME_REMOVE_HANDLES = 3000;\r\n\r\nconst MOVEMENT_RATIO = 0.5;\r\n\r\nexport enum ImageHandleKind {\r\n    Stretch,\r\n    RotateAndScale,\r\n    Anchor,\r\n}\r\nexport interface ImageHandle {\r\n    x: number;\r\n    y: number;\r\n    x_start?: number;\r\n    y_start?: number;\r\n    nearestTouch?: number;\r\n    kind?: ImageHandleKind;\r\n}\r\nexport interface ImageHandles {\r\n    [key: string]: ImageHandle;\r\n}\r\n\r\nexport interface UserFittingOptions {\r\n    host: HTMLDivElement;\r\n    userImageUrl: string;\r\n    userImageHandles: ImageHandles;\r\n    productImageUrl: string;\r\n    productImageHandles: ImageHandles;\r\n    onMove?: (moveArgs: MoveArgs) => void;\r\n    shouldMoveProductHandles?: boolean;\r\n    moveHandleRadius?: number;\r\n}\r\n\r\nexport interface MoveArgs {\r\n    imageHandles: ImageHandles;\r\n    imageHandles_old: ImageHandles;\r\n    delta_productImageHandles: ImageHandles;\r\n}\r\n\r\nexport interface Rect {\r\n    y_top: number;\r\n    y_bottom: number;\r\n    x_left: number;\r\n    x_right: number;\r\n}\r\n\r\nexport interface SkewRect {\r\n    y_top_left: number;\r\n    y_bottom_left: number;\r\n    y_top_right: number;\r\n    y_bottom_right: number;\r\n\r\n    x_bottom_left: number;\r\n    x_bottom_right: number;\r\n    x_top_left: number;\r\n    x_top_right: number;\r\n}\r\n\r\nexport interface TransformCell {\r\n    source: Rect;\r\n    target: SkewRect;\r\n}\r\n\r\nexport function setupUserFitting(options: UserFittingOptions) {\r\n\r\n    const shouldMoveProductHandles = options.shouldMoveProductHandles;\r\n    const moveHandleRadius = options.moveHandleRadius || DEFAULT_MOVE_HANDLE_RADIUS;\r\n    const MAX_MOVE_DISTANCE_SQ = moveHandleRadius * moveHandleRadius;\r\n\r\n    options.productImageHandles = clone(options.productImageHandles);\r\n\r\n    let cvs = document.createElement('canvas');\r\n    options.host.appendChild(cvs);\r\n    cvs.width = options.host.clientWidth;\r\n    cvs.height = options.host.clientHeight;\r\n    cvs.style.width = '100%';\r\n\r\n    let w = cvs.width | 600;\r\n    let h = cvs.height | 600;\r\n\r\n    // // Oversize to be able to see better\r\n    // if (DEBUG) {\r\n    //     cvs.width = 1200;\r\n    //     cvs.height = 800;\r\n\r\n    //     w = 600;\r\n    //     h = 600;\r\n    // }\r\n\r\n    let ctx = cvs.getContext('2d');\r\n\r\n    if (DEBUG) {\r\n        ctx.strokeStyle = '#000000';\r\n        ctx.lineWidth = 4;\r\n        ctx.strokeRect(0, 0, w, h);\r\n    }\r\n    // TODO: Add Image Loader (for iOS)\r\n\r\n    let userImage = new Image();\r\n    userImage.onload = () => {\r\n\r\n        // ctx.save();\r\n        // ctx.globalAlpha = 0.15;\r\n        // ctx.drawImage(userImage, 0, 0);\r\n        // ctx.restore();\r\n        // c.width = userImage.width;\r\n        // c.height = userImage.height;\r\n\r\n        refresh();\r\n    };\r\n    userImage.src = options.userImageUrl;\r\n\r\n    let productImage = new Image();\r\n    productImage.onload = () => {\r\n\r\n        if (DEBUG) {\r\n            ctx.save();\r\n            ctx.globalAlpha = 0.15;\r\n            ctx.drawImage(productImage, 0, 0);\r\n            ctx.restore();\r\n        }\r\n\r\n        refresh();\r\n    };\r\n    productImage.src = options.productImageUrl;\r\n\r\n    let productImage_adjusted: HTMLCanvasElement;\r\n\r\n    let refresh = () => {\r\n        if (!userImage.width || !productImage.width) {\r\n            setTimeout(refresh, 250);\r\n            return;\r\n        }\r\n\r\n        let c = { context: ctx, width: w || 600, height: h || 600 };\r\n\r\n        // if (!DEBUG) {\r\n        c.width = w = cvs.width;\r\n        c.height = h = cvs.height;\r\n        //}\r\n\r\n        // Debug - Draw with shadows\r\n        // if (productImage_adjusted == null) {\r\n\r\n        //     let buffer = new DrawingBuffer(productImage.width, productImage.height);\r\n        //     drawWithShade(buffer.context, productImage.width, productImage.height, '#000000', 0.15, ctx2 => {\r\n        //         ctx2.drawImage(productImage, 0, 0, productImage.width, productImage.height);\r\n        //     });\r\n\r\n        //     productImage_adjusted = buffer.canvas;\r\n\r\n\r\n        // }\r\n\r\n        // // Resize for aspect ratio\r\n        // if (productImage_adjusted == null) {\r\n\r\n        //     // const aspectRatio = productImage.width / productImage.height;\r\n        //     const aspectRatio = 1;\r\n\r\n        //     let buffer = new DrawingBuffer(productImage.width, aspectRatio * productImage.height);\r\n        //     // drawWithShade(buffer.context, productImage.width, productImage.height, '#000000', 0.15, ctx2 => {\r\n        //     //     ctx2.drawImage(productImage, 0, 0, productImage.width, productImage.height);\r\n        //     // });\r\n        //     buffer.context.drawImage(productImage, 0, 0, productImage.width, productImage.height);\r\n        //     productImage_adjusted = buffer.canvas;\r\n\r\n\r\n        //     for (let key in options.productImageHandles) {\r\n        //         if (options.productImageHandles.hasOwnProperty(key)) {\r\n        //             const handle = options.productImageHandles[key];\r\n\r\n        //             log('handle y before', handle.y, aspectRatio);\r\n        //             handle.y = handle.y / aspectRatio;\r\n        //             log('handle y after', handle.y, aspectRatio);\r\n        //         }\r\n        //     }\r\n        // }\r\n\r\n        // TODO: Re-implement dragging\r\n        const actual = refreshUserFitting_simple(c, userImage, productImage, options, shouldDrawHandles);\r\n\r\n        // if (!isDraggingNearest && !isMovingProduct) {\r\n        // handles_move[0].x = actual.a.u;\r\n        // handles_move[0].y = actual.a.v;\r\n        // handles_move[1].x = actual.b.u;\r\n        // handles_move[1].y = actual.b.v;\r\n        // }\r\n\r\n        // refreshUserFitting_simple(c, userImage, productImage_adjusted, options);\r\n\r\n        if (shouldMoveProductHandles) {\r\n            ctx.globalAlpha = 0.75;\r\n            ctx.drawImage(productImage_adjusted, 0, 0, w, h);\r\n            ctx.globalAlpha = 1;\r\n\r\n            drawHandles(ctx, w, h, options.productImageHandles, '#FFFF00');\r\n        }\r\n    };\r\n\r\n    setTimeout(refresh, 250);\r\n\r\n    let handles_move: ImageHandle[] = [];\r\n\r\n    if (!shouldMoveProductHandles) {\r\n        for (let k in options.userImageHandles) {\r\n            if (options.productImageHandles[k]) {\r\n                handles_move.push(options.userImageHandles[k]);\r\n            }\r\n        }\r\n    } else {\r\n        // Move the product handles instead\r\n        for (let k in options.userImageHandles) {\r\n            if (options.productImageHandles[k]) {\r\n                handles_move.push(options.productImageHandles[k]);\r\n            }\r\n        }\r\n    }\r\n\r\n    let getHandleInfo = (e: any) => {\r\n\r\n        let rect = cvs.getBoundingClientRect();\r\n        let xm = 0;\r\n        let ym = 0;\r\n        let xm2 = null as number;\r\n        let ym2 = null as number;\r\n\r\n\r\n        if (e.clientX != null) {\r\n            xm = e.clientX - rect.left;\r\n            ym = e.clientY - rect.top;\r\n        } else if (e.touches != null) {\r\n            xm = e.touches[0].clientX - rect.left;\r\n            ym = e.touches[0].clientY - rect.top;\r\n\r\n            if (e.touches[1]) {\r\n                if (DEBUG_MOUSE) { console.log('2 FINGER'); }\r\n\r\n                xm2 = e.touches[1].clientX - rect.left;\r\n                ym2 = e.touches[1].clientY - rect.top;\r\n            }\r\n        }\r\n\r\n        if (DEBUG_MOUSE) {\r\n            console.log('Mouse Down', xm, ym, xm2, ym2, e);\r\n        }\r\n        let xh = xm / w;\r\n        let yh = ym / h;\r\n        let nearest = handles_move.map(s => ({ handle: s, distanceSq: (s.x - xh) * (s.x - xh) + (s.y - yh) * (s.y - yh) })).sort((a, b) => a.distanceSq - b.distanceSq)[0];\r\n        let xh2 = xm2 ? xm2 / w : null;\r\n        let yh2 = ym2 ? ym2 / h : null;\r\n\r\n\r\n        return { xh, yh, nearest, xh2, yh2 };\r\n    };\r\n\r\n\r\n    let shouldDrawHandles = false;\r\n    let isMovingProduct = false;\r\n    let isDraggingNearest = false;\r\n    let xh_start = 0;\r\n    let yh_start = 0;\r\n    let hNearest: ImageHandle = null;\r\n    let xh2_start = 0;\r\n    let yh2_start = 0;\r\n\r\n    // let userHandles_old = clone(options.userImageHandles);\r\n    // let productHandles_old = clone(options.productImageHandles);\r\n\r\n    let dragEnd = () => {\r\n        unsubscribe();\r\n        isDraggingNearest = isMovingProduct = false;\r\n\r\n        // // Report move\r\n        // if (options.onMove) {\r\n\r\n        //     const userHandles_new = clone(options.userImageHandles);\r\n        //     const delta_productImageHandles = {} as ImageHandles;\r\n\r\n        //     // for (let k in userHandles_new) {\r\n        //     //     if (userHandles_new.hasOwnProperty(k)) {\r\n        //     //         delta_productImageHandles[k] = \r\n        //     //     }\r\n        //     // }\r\n\r\n        //     options.onMove({\r\n        //         imageHandles: userHandles_new,\r\n        //         imageHandles_old: userHandles_old,\r\n        //         delta_productImageHandles\r\n        //     });\r\n\r\n        //     userHandles_old = clone(options.userImageHandles);\r\n        //     productHandles_old = clone(options.productImageHandles);\r\n        // }\r\n    };\r\n\r\n    let dragStart = (e: any) => {\r\n        subscribe();\r\n\r\n        let {xh, yh, nearest, xh2, yh2} = getHandleInfo(e);\r\n\r\n        xh_start = xh;\r\n        yh_start = yh;\r\n        xh2_start = xh2;\r\n        yh2_start = yh2;\r\n\r\n        handles_move.forEach(s => {\r\n            s.x_start = s.x;\r\n            s.y_start = s.y;\r\n\r\n            s.nearestTouch = 0;\r\n            if (xh2 != null) {\r\n                let xhd = s.x - xh;\r\n                let yhd = s.y - yh;\r\n                let xhd2 = s.x - xh2;\r\n                let yhd2 = s.y - yh2;\r\n                if (xhd * xhd + yhd * yhd\r\n                    > xhd2 * xhd2 + yhd2 * yhd2\r\n                ) {\r\n                    s.nearestTouch = 1;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (nearest.distanceSq < MAX_DRAG_DISTANCE_SQ) {\r\n            isDraggingNearest = true;\r\n            hNearest = nearest.handle;\r\n        } else if (nearest.distanceSq < MAX_MOVE_DISTANCE_SQ) {\r\n            isMovingProduct = true;\r\n        }\r\n\r\n        if (DEBUG_MOUSE) {\r\n            console.log('isDraggingPoint', isDraggingNearest, 'isMovingProduct', isMovingProduct);\r\n            drawHandles(ctx, w, h, handles_move, '#00FF00');\r\n            drawHandles(ctx, w, h, [nearest.handle], '#FF0000');\r\n        }\r\n    };\r\n\r\n    let timeoutId = -1;\r\n\r\n    let dragMove = (e: MouseEvent) => {\r\n        if (!isDraggingNearest && !isMovingProduct) { return; }\r\n\r\n        // Move the nearest handle\r\n        let {xh, yh, nearest, xh2, yh2} = getHandleInfo(e);\r\n\r\n        if (isDraggingNearest) {\r\n            let s = hNearest;\r\n            s.x = s.x_start + (xh - xh_start) * MOVEMENT_RATIO;\r\n            s.y = s.y_start + (yh - yh_start) * MOVEMENT_RATIO;\r\n        } else if (isMovingProduct) {\r\n            handles_move.forEach(s => {\r\n\r\n                let xhd = xh - xh_start;\r\n                let yhd = yh - yh_start;\r\n                let xhd2 = xh2 - xh2_start;\r\n                let yhd2 = yh2 - yh2_start;\r\n\r\n                if (xh2 == null) {\r\n                    s.x = s.x_start + xhd * MOVEMENT_RATIO;\r\n                    s.y = s.y_start + yhd * MOVEMENT_RATIO;\r\n                } else {\r\n                    // Each point moves with nearest finger\r\n                    if (s.nearestTouch === 0) {\r\n                        s.x = s.x_start + xhd * MOVEMENT_RATIO;\r\n                        s.y = s.y_start + yhd * MOVEMENT_RATIO;\r\n                    } else {\r\n                        s.x = s.x_start + xhd2 * MOVEMENT_RATIO;\r\n                        s.y = s.y_start + yhd2 * MOVEMENT_RATIO;\r\n                    }\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        refresh();\r\n\r\n        shouldDrawHandles = true;\r\n        // drawHandles(ctx, w, h, handles_move, '#0000FF');\r\n        // if (isDraggingNearest) {\r\n        //     drawHandles(ctx, w, h, [hNearest], '#00FF00');\r\n        // }\r\n        // else {\r\n        //     let xMain = handles_move.reduce((out, s) => out += s.x, 0) / handles_move.length;\r\n        //     let yMain = handles_move.reduce((out, s) => out += s.y, 0) / handles_move.length;\r\n        //     drawMainHandle(ctx, w, h, xMain, yMain, '#00FF00');\r\n        // }\r\n\r\n        let removeHandles = () => {\r\n            clearTimeout(timeoutId);\r\n            timeoutId = setTimeout(() => {\r\n                if (isDraggingNearest) { removeHandles(); return; }\r\n                shouldDrawHandles = false;\r\n                refresh();\r\n            }, TIME_REMOVE_HANDLES);\r\n        };\r\n\r\n        removeHandles();\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        return false;\r\n    };\r\n\r\n    cvs.addEventListener('mousedown', dragStart);\r\n    cvs.addEventListener('touchstart', dragStart);\r\n\r\n    const subscribe = () => {\r\n        // console.log('subscribe');\r\n\r\n        window.addEventListener('mouseup', dragEnd);\r\n        window.addEventListener('touchend', dragEnd);\r\n        window.addEventListener('mousemove', dragMove);\r\n        window.addEventListener('touchmove', dragMove, { passive: false } as any);\r\n    };\r\n\r\n    const unsubscribe = () => {\r\n        // console.log('unsubscribe');\r\n\r\n        window.removeEventListener('mouseup', dragEnd);\r\n        window.removeEventListener('touchend', dragEnd);\r\n        window.removeEventListener('mousemove', dragMove);\r\n        window.removeEventListener('touchmove', dragMove);\r\n    };\r\n}\r\n\r\nfunction log(message: any, ...args: any[]) {\r\n    if (DEBUG) {\r\n        console.log(message, ...args);\r\n    }\r\n}\r\n\r\nfunction clone(obj: any) {\r\n    const c = {} as any;\r\n    for (let k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            if (typeof obj[k] === 'object') {\r\n                c[k] = clone(obj[k]);\r\n            } else {\r\n                c[k] = obj[k];\r\n            }\r\n        }\r\n    }\r\n\r\n    return c;\r\n}\r\n\r\nfunction refreshUserFitting_simple(c: DrawingContext, userImage: HTMLImageElement, productImage: HTMLImageElement | HTMLCanvasElement, options: UserFittingOptions, shouldDrawHandles: boolean) {\r\n    // log('refresh');\r\n\r\n    c.context.clearRect(0, 0, c.width, c.height);\r\n    const actualPosition = drawImagesAligned(c, [toSimpleImageInfo(userImage, options.userImageHandles), toSimpleImageInfo(productImage, options.productImageHandles)], shouldDrawHandles);\r\n    return actualPosition;\r\n}\r\n\r\nfunction toSimpleImageInfo(image: HTMLImageElement | HTMLCanvasElement, imageHandles: ImageHandles): ImagePosition {\r\n    const aHandle = imageHandles['left_temple'];\r\n    const bHandle = imageHandles['right_temple'];\r\n\r\n    return {\r\n        image,\r\n        a: { u: aHandle.x, v: aHandle.y },\r\n        b: { u: bHandle.x, v: bHandle.y },\r\n    };\r\n}\r\n\r\n\r\nfunction refreshUserFitting_old(c: DrawingContext, userImage: HTMLImageElement, productImage: HTMLImageElement | HTMLCanvasElement, options: UserFittingOptions) {\r\n    log('refresh');\r\n\r\n    c.context.clearRect(0, 0, c.width, c.height);\r\n    c.context.drawImage(userImage, 0, 0, c.width, c.height);\r\n    drawImageAligned(c, productImage, options.productImageHandles, options.userImageHandles);\r\n}\r\n\r\nfunction drawImageAligned(c: DrawingContext, image: HTMLImageElement | HTMLCanvasElement, handles: ImageHandles, handleTargets: ImageHandles) {\r\n    let ctx = c.context;\r\n    let w = c.width;\r\n    let h = c.height;\r\n\r\n    let handlesMerged: { source: ImageHandle, target: ImageHandle }[] = [];\r\n\r\n    for (let k in handles) {\r\n        handlesMerged.push({ source: handles[k], target: handleTargets[k] });\r\n    }\r\n\r\n    handlesMerged = handlesMerged.sort((a, b) => a.source.x - b.source.x);\r\n\r\n    // Just do a row of cells for now (only vertical dividers)\r\n    let handles_stretches = handlesMerged.filter(x => x.source.kind !== ImageHandleKind.Anchor);\r\n\r\n    let gaps = handles_stretches.map((s, i) => ({ i: i, prev: s, next: handles_stretches[i + 1], xDistance: (handles_stretches[i + 1] || { source: { x: s.source.x } }).source.x - s.source.x }));\r\n    gaps.sort((a, b) => b.xDistance - a.xDistance);\r\n    log('gaps', gaps);\r\n\r\n    let widest = gaps[0];\r\n\r\n    let targetScale =\r\n        (widest.next.target.x - widest.prev.target.x) /\r\n        (widest.next.source.x - widest.prev.source.x);\r\n\r\n    let y_delta_source = widest.next.source.y - widest.prev.source.y;\r\n    let x_delta_source = widest.next.source.x - widest.prev.source.x;\r\n    let y_delta_target = widest.next.target.y - widest.prev.target.y;\r\n    let x_delta_target = widest.next.target.x - widest.prev.target.x;\r\n\r\n    let sourceAngle = Math.atan(y_delta_source / x_delta_source);\r\n    let targetAngle = Math.atan(y_delta_target / x_delta_target);\r\n    let mainAngle = targetAngle - sourceAngle;\r\n\r\n    // TEMP: Testing\r\n    // mainAngle = 0;\r\n\r\n    log('targetScale', targetScale,\r\n        'y_delta_source', y_delta_source,\r\n        'x_delta_source', x_delta_source,\r\n        'y_delta_target', y_delta_target,\r\n        'x_delta_target', x_delta_target,\r\n        'sourceAngle', sourceAngle * 180 / Math.PI,\r\n        'targetAngle', targetAngle * 180 / Math.PI,\r\n        'mainAngle', mainAngle * 180 / Math.PI,\r\n    );\r\n\r\n    ctx.save();\r\n    // ctx.rotate(mainAngle);\r\n\r\n    // Calculate y_top and y_bottom for each stretch handle\r\n    let stretches = handles_stretches.map(s => {\r\n        let sourceLeft_yRatioFromTop = s.source.y;\r\n        let sourceLeft_yRatioFromBottom = 1 - sourceLeft_yRatioFromTop;\r\n\r\n        let targetTop = s.target.y - targetScale * sourceLeft_yRatioFromTop;\r\n        let targetBottom = s.target.y + targetScale * sourceLeft_yRatioFromBottom;\r\n\r\n        return {\r\n            source: s.source,\r\n            target_orig: s.target,\r\n            target: s.target,\r\n            x_top_target: s.target.x + rotateX(0, targetTop - s.target.y, mainAngle),\r\n            x_bottom_target: s.target.x + rotateX(0, targetBottom - s.target.y, mainAngle),\r\n            y_top_target: s.target.y + rotateY(0, targetTop - s.target.y, mainAngle),\r\n            y_bottom_target: s.target.y + rotateY(0, targetBottom - s.target.y, mainAngle),\r\n\r\n            // target: s.target,\r\n            // x_top_target: s.target.x,\r\n            // x_bottom_target: s.target.x,\r\n            // y_top_target: targetTop,\r\n            // y_bottom_target: targetBottom,\r\n\r\n            // target: rotate(s.target, mainAngle),\r\n            // x_top_target: rotateX(s.target.x, targetTop, mainAngle),\r\n            // x_bottom_target: rotateX(s.target.x, targetBottom, mainAngle),\r\n            // y_top_target: rotateY(s.target.x, targetTop, mainAngle),\r\n            // y_bottom_target: rotateY(s.target.x, targetBottom, mainAngle),\r\n\r\n\r\n            // target: rotate(s.target, -mainAngle),\r\n            // x_top_target: rotateX(s.target.x, targetTop, -mainAngle),\r\n            // x_bottom_target: rotateX(s.target.x, targetBottom, -mainAngle),\r\n            // y_top_target: rotateY(s.target.x, targetTop, -mainAngle),\r\n            // y_bottom_target: rotateY(s.target.x, targetBottom, -mainAngle),\r\n            // y_top_target: targetTop,\r\n            // y_bottom_target: targetBottom,\r\n        };\r\n    });\r\n\r\n\r\n    let columnCount = stretches.length - 1;\r\n\r\n    let grid: TransformCell[][] = [];\r\n\r\n    gaps.reverse();\r\n    let columnOrder: number[] = gaps.filter(g => g.xDistance > 0).map(g => g.i);\r\n\r\n    for (let ic = 0; ic < columnCount; ic++) {\r\n\r\n        let i = columnOrder[ic];\r\n        let sourceTop = 0;\r\n        let sourceBottom = 1;\r\n\r\n        let left = stretches[i];\r\n        let right = stretches[i + 1];\r\n\r\n        let sourceLeft = left.source.x;\r\n        let sourceRight = right.source.x;\r\n\r\n        let targetLeft = left.target.x;\r\n        let targetRight = right.target.x;\r\n\r\n        let x_top_left_target = left.x_top_target;\r\n        let x_bottom_left_target = left.x_bottom_target;\r\n        let x_top_right_target = right.x_top_target;\r\n        let x_bottom_right_target = right.x_bottom_target;\r\n\r\n        // Calculate the y scale\r\n        let y_top_left_target = left.y_top_target;\r\n        let y_bottom_left_target = left.y_bottom_target;\r\n        let y_top_right_target = right.y_top_target;\r\n        let y_bottom_right_target = right.y_bottom_target;\r\n\r\n        if (i === 0) {\r\n            let changeRatio = (sourceRight - 0) / (sourceRight - sourceLeft);\r\n            let targetPerSourceScale = (targetRight - targetLeft) / (sourceRight - sourceLeft);\r\n            // targetLeft = targetRight - targetPerSourceScale * sourceRight;\r\n            x_top_left_target = x_top_right_target - targetPerSourceScale * sourceRight;\r\n            x_bottom_left_target = x_bottom_right_target - targetPerSourceScale * sourceRight;\r\n\r\n            sourceLeft = 0;\r\n\r\n            y_top_left_target = y_top_right_target - changeRatio * (y_top_right_target - y_top_left_target);\r\n            y_bottom_left_target = y_bottom_right_target - changeRatio * (y_bottom_right_target - y_bottom_left_target);\r\n        }\r\n\r\n        if (i === columnCount - 1) {\r\n            let changeRatio = (1 - sourceLeft) / (sourceRight - sourceLeft);\r\n            let tScale = (targetRight - targetLeft) / (sourceRight - sourceLeft);\r\n            // targetRight = targetLeft + tScale * (1 - sourceLeft);\r\n            x_top_right_target = x_top_left_target + tScale * (1 - sourceLeft);\r\n            x_bottom_right_target = x_bottom_left_target + tScale * (1 - sourceLeft);\r\n\r\n            sourceRight = 1;\r\n\r\n            y_top_right_target = y_top_left_target + changeRatio * (y_top_right_target - y_top_left_target);\r\n            y_bottom_right_target = y_bottom_left_target + changeRatio * (y_bottom_right_target - y_bottom_left_target);\r\n        }\r\n\r\n\r\n        grid.push([{\r\n            source: { x_left: sourceLeft, x_right: sourceRight, y_top: sourceTop, y_bottom: sourceBottom },\r\n            target: {\r\n                x_top_left: x_top_left_target, x_bottom_left: x_bottom_left_target, x_top_right: x_top_right_target, x_bottom_right: x_bottom_right_target,\r\n                y_top_left: y_top_left_target, y_bottom_left: y_bottom_left_target, y_top_right: y_top_right_target, y_bottom_right: y_bottom_right_target\r\n            }\r\n        }]);\r\n\r\n\r\n        let g = grid[grid.length - 1][0];\r\n\r\n        log('Source:', g.source);\r\n        log('Target:', g.target);\r\n\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.source.x_left, h * g.source.y_top,\r\n        //     w * g.source.x_right, h * g.source.y_top,\r\n        //     w * g.source.x_left, h * g.source.y_bottom,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_bottom\r\n        // );\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.source.x_right, h * g.source.y_top,\r\n        //     w * g.source.x_right, h * g.source.y_bottom,\r\n        //     w * g.source.x_left, h * g.source.y_bottom,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_bottom,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_bottom\r\n        // );\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.target.x_left, h * g.target.y_top,\r\n        //     w * g.target.x_right, h * g.target.y_top,\r\n        //     w * g.target.x_left, h * g.target.y_bottom,\r\n        //     image.width * g.target.x_left, image.height * g.target.y_top,\r\n        //     image.width * g.target.x_right, image.height * g.target.y_top,\r\n        //     image.width * g.target.x_left, image.height * g.target.y_bottom\r\n        // );\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.target.x_right, h * g.target.y_top,\r\n        //     w * g.target.x_right, h * g.target.y_bottom,\r\n        //     w * g.target.x_left, h * g.target.y_bottom,\r\n        //     image.width * g.target.x_right, image.height * g.target.y_top,\r\n        //     image.width * g.target.x_right, image.height * g.target.y_bottom,\r\n        //     image.width * g.target.x_left, image.height * g.target.y_bottom\r\n        // );\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.target.x_left, h * g.target.y_top_left,\r\n        //     w * g.target.x_right, h * g.target.y_top_right,\r\n        //     w * g.target.x_left, h * g.target.y_bottom_left,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_bottom, DEBUG\r\n        // );\r\n\r\n        // drawTriangle(ctx, image,\r\n        //     w * g.target.x_right, h * g.target.y_top_right,\r\n        //     w * g.target.x_right, h * g.target.y_bottom_right,\r\n        //     w * g.target.x_left, h * g.target.y_bottom_left,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_top,\r\n        //     image.width * g.source.x_right, image.height * g.source.y_bottom,\r\n        //     image.width * g.source.x_left, image.height * g.source.y_bottom, DEBUG\r\n        // );\r\n\r\n        drawWithEdgeBlur(ctx, w, h, (ctx2) => {\r\n            drawQuad(ctx2, image,\r\n                w * g.target.x_top_left, h * g.target.y_top_left,\r\n                w * g.target.x_top_right, h * g.target.y_top_right,\r\n                w * g.target.x_bottom_right, h * g.target.y_bottom_right,\r\n                w * g.target.x_bottom_left, h * g.target.y_bottom_left,\r\n                image.width * g.source.x_left, image.height * g.source.y_top,\r\n                image.width * g.source.x_right, image.height * g.source.y_top,\r\n                image.width * g.source.x_right, image.height * g.source.y_bottom,\r\n                image.width * g.source.x_left, image.height * g.source.y_bottom,\r\n                DEBUG\r\n            );\r\n        });\r\n\r\n        // break;\r\n    }\r\n\r\n    if (DEBUG) {\r\n\r\n        stretches.forEach(s => {\r\n            log('draw stretch', s);\r\n            ctx.beginPath();\r\n            ctx.strokeStyle = '#FF00FF';\r\n            ctx.moveTo(w * s.target_orig.x, h * s.target_orig.y);\r\n            ctx.lineTo(w * s.target.x, h * s.target.y);\r\n            ctx.stroke();\r\n            // ctx.beginPath();\r\n            // ctx.strokeStyle = '#00FFFF';\r\n            // ctx.moveTo(w * s.target.x, h * s.target.x);\r\n            // ctx.stroke();\r\n        });\r\n\r\n        drawHandles(ctx, w, h, stretches.map(s => s.target) as any as ImageHandles, '#FF00FF');\r\n        drawHandles(ctx, w, h, handles, '#FF0000');\r\n        drawHandles(ctx, w, h, handleTargets, '#00FF00');\r\n        let xMain = stretches.reduce((out, s) => out += s.target.x, 0) / stretches.length;\r\n        let yMain = stretches.reduce((out, s) => out += s.target.y, 0) / stretches.length;\r\n        drawMainHandle(ctx, w, h, xMain, yMain, '#00FF00');\r\n    }\r\n\r\n    ctx.restore();\r\n}\r\n\r\nfunction rotate(handle: ImageHandle, angle: number): ImageHandle {\r\n    let x_rotate = handle.x * Math.cos(angle) - handle.y * Math.sin(angle);\r\n    let y_rotate = handle.x * Math.sin(angle) + handle.y * Math.cos(angle);\r\n\r\n    return {\r\n        kind: handle.kind,\r\n        x: x_rotate,\r\n        y: y_rotate,\r\n    };\r\n}\r\n\r\nfunction rotateX(x: number, y: number, angle: number): number {\r\n    let x_rotate = x * Math.cos(angle) - y * Math.sin(angle);\r\n    return x_rotate;\r\n}\r\n\r\n\r\nfunction rotateY(x: number, y: number, angle: number): number {\r\n    let y_rotate = x * Math.sin(angle) + y * Math.cos(angle);\r\n\r\n    return y_rotate;\r\n}\r\n\r\nfunction calculateScale(s0: number, s1: number, t0: number, t1: number) {\r\n    // if (s0 <= s1 || t0 <= t1) { return 0; }\r\n    return (t1 - t0) / (s1 - s0);\r\n}\r\n\r\nfunction calculateSkewY(sx0: number, sx1: number, sy0: number, sy1: number, ty0: number, ty1: number) {\r\n    let dsx = sx1 - sx0;\r\n    let dsy = sy1 - sy0;\r\n    let dty = ty1 - ty0;\r\n\r\n    return (dty - dsy) / dsx;\r\n}\r\n\r\nfunction drawHandles(ctx: CanvasRenderingContext2D, w: number, h: number, handles: ImageHandles | ImageHandle[], color: string) {\r\n\r\n    let radius = HANDLE_RADIUS * w;\r\n    let thickness = 2;\r\n    for (let k in handles) {\r\n        log('draw handle');\r\n\r\n        let handle = (handles as any)[k];\r\n        ctx.globalAlpha = 0.5;\r\n        ctx.lineWidth = thickness;\r\n        ctx.strokeStyle = color;\r\n\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(handle.x * w - radius, handle.y * h);\r\n        // ctx.lineTo(handle.x * w + radius, handle.y * h);\r\n        // ctx.stroke();\r\n\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(handle.x * w, handle.y * h - radius);\r\n        // ctx.lineTo(handle.x * w, handle.y * h + radius);\r\n        // ctx.stroke();\r\n\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color;\r\n        ctx.arc(handle.x * w, handle.y * h, radius * 0.25, 0, Math.PI * 2, false);\r\n        ctx.fill();\r\n        ctx.globalAlpha = 1;\r\n    }\r\n\r\n\r\n}\r\n\r\nfunction drawMainHandle(ctx: CanvasRenderingContext2D, w: number, h: number, x: number, y: number, color: string) {\r\n    // ctx.beginPath();\r\n    // ctx.globalAlpha = 1;\r\n    // ctx.strokeStyle = color;\r\n    // ctx.arc(x * w, y * h, MOVE_RADIUS * w, 0, Math.PI * 2, false);\r\n    // //   ctx.arc(x * w, y * h, 0.01 * MOVE_RADIUS * w, 0, Math.PI * 2, false);\r\n    // ctx.stroke();\r\n    // ctx.globalAlpha = 1;\r\n}\r\n\r\nfunction drawImageSection(ctx: CanvasRenderingContext2D, image: HTMLImageElement, handle: ImageHandles, handleTargets: ImageHandles) {\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/user-fitting.ts","// Based on: jsgl.js https://github.com/spoulson/Code-snippets/blob/master/Javascript/jsgl/jsgl.js\r\n// For pixel rounding purposes during clipping:\r\n// (x0,y0) = (top, left)\r\n// (x1,y1) = (top, right)\r\n// (x2,y2) = (bottom, right)\r\n// (x3,y3) = (bottom, left)\r\nexport function drawQuad(\r\n    ctx: CanvasRenderingContext2D,\r\n    image: HTMLImageElement | HTMLCanvasElement,\r\n    x0: number,\r\n    y0: number,\r\n    x1: number,\r\n    y1: number,\r\n    x2: number,\r\n    y2: number,\r\n    x3: number,\r\n    y3: number,\r\n    sx0: number,\r\n    sy0: number,\r\n    sx1: number,\r\n    sy1: number,\r\n    sx2: number,\r\n    sy2: number,\r\n    sx3: number,\r\n    sy3: number,\r\n    wireframe = false\r\n) {\r\n    if (wireframe) {\r\n        ctx.lineWidth = 0.5;\r\n        ctx.strokeStyle = '#00FF00';\r\n        ctx.beginPath();\r\n        ctx.moveTo(x0, y0);\r\n        ctx.lineTo(x1, y1);\r\n        ctx.lineTo(x2, y2);\r\n        ctx.lineTo(x3, y3);\r\n        ctx.lineTo(x0, y0);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.strokeStyle = '#0000FF';\r\n        ctx.beginPath();\r\n        ctx.moveTo(sx0, sy0);\r\n        ctx.lineTo(sx1, sy1);\r\n        ctx.lineTo(sx2, sy2);\r\n        ctx.lineTo(sx3, sy3);\r\n        ctx.lineTo(sx0, sy0);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    // console.log(`Target: (${x0},${y0})-(${x1},${y1})-(${x2},${y2})`);\r\n    // console.log(`Source: (${sx0},${sy0})-(${sx1},${sy1})-(${sx2},${sy2})`);\r\n\r\n    ctx.save();\r\n\r\n    // Clip the output to the on-screen triangle boundaries.\r\n    ctx.beginPath();\r\n    // ctx.moveTo(x0, y0);\r\n    // ctx.lineTo(x1, y1);\r\n    // ctx.lineTo(x2, y2);\r\n    // ctx.lineTo(x3, y3);\r\n\r\n    // Remove border lines\r\n    ctx.moveTo(Math.floor(x0), Math.floor(y0));\r\n    ctx.lineTo(Math.ceil(x1), Math.floor(y1));\r\n    ctx.lineTo(Math.ceil(x2), Math.ceil(y2));\r\n    ctx.lineTo(Math.floor(x3), Math.ceil(y3));\r\n\r\n    ctx.closePath();\r\n    // ctx.stroke();//xxxxxxx for wireframe\r\n    ctx.clip();\r\n\r\n    /*\r\n      ctx.transform(m11, m12, m21, m22, dx, dy) sets the context transform matrix.\r\n      The context matrix is:\r\n      [ m11 m21 dx ]\r\n      [ m12 m22 dy ]\r\n      [  0   0   1 ]\r\n      Coords are column vectors with a 1 in the z coord, so the transform is:\r\n      x_out = m11 * x + m21 * y + dx;\r\n      y_out = m12 * x + m22 * y + dy;\r\n      From Maxima, these are the transform values that map the source\r\n      coords to the dest coords:\r\n      sy0 (x2 - x1) - sy1 x2 + sy2 x1 + (sy1 - sy2) x0\r\n      [m11 = - -----------------------------------------------------,\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n      sy1 y2 + sy0 (y1 - y2) - sy2 y1 + (sy2 - sy1) y0\r\n      m12 = -----------------------------------------------------,\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n      sx0 (x2 - x1) - sx1 x2 + sx2 x1 + (sx1 - sx2) x0\r\n      m21 = -----------------------------------------------------,\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n      sx1 y2 + sx0 (y1 - y2) - sx2 y1 + (sx2 - sx1) y0\r\n      m22 = - -----------------------------------------------------,\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n      sx0 (sy2 x1 - sy1 x2) + sy0 (sx1 x2 - sx2 x1) + (sx2 sy1 - sx1 sy2) x0\r\n      dx = ----------------------------------------------------------------------,\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n      sx0 (sy2 y1 - sy1 y2) + sy0 (sx1 y2 - sx2 y1) + (sx2 sy1 - sx1 sy2) y0\r\n      dy = ----------------------------------------------------------------------]\r\n      sx0 (sy2 - sy1) - sx1 sy2 + sx2 sy1 + (sx1 - sx2) sy0\r\n    */\r\n\r\n    // TODO: eliminate common subexpressions.\r\n    let denom = sx0 * (sy2 - sy1) - sx1 * sy2 + sx2 * sy1 + (sx1 - sx2) * sy0;\r\n    if (denom === 0) {\r\n        return;\r\n    }\r\n    let m11 = - (sy0 * (x2 - x1) - sy1 * x2 + sy2 * x1 + (sy1 - sy2) * x0) / denom;\r\n    let m12 = (sy1 * y2 + sy0 * (y1 - y2) - sy2 * y1 + (sy2 - sy1) * y0) / denom;\r\n    let m21 = (sx0 * (x2 - x1) - sx1 * x2 + sx2 * x1 + (sx1 - sx2) * x0) / denom;\r\n    let m22 = - (sx1 * y2 + sx0 * (y1 - y2) - sx2 * y1 + (sx2 - sx1) * y0) / denom;\r\n    let dx = (sx0 * (sy2 * x1 - sy1 * x2) + sy0 * (sx1 * x2 - sx2 * x1) + (sx2 * sy1 - sx1 * sy2) * x0) / denom;\r\n    let dy = (sx0 * (sy2 * y1 - sy1 * y2) + sy0 * (sx1 * y2 - sx2 * y1) + (sx2 * sy1 - sx1 * sy2) * y0) / denom;\r\n\r\n    ctx.transform(m11, m12, m21, m22, dx, dy);\r\n\r\n    // Draw the whole image.  Transform and clip will map it onto the\r\n    // correct output triangle.\r\n    //\r\n    // TODO: figure out if drawImage goes faster if we specify the rectangle that\r\n    // bounds the source coords.\r\n    ctx.drawImage(image, 0, 0);\r\n    ctx.restore();\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/draw-quad.ts","import { DrawingBuffer } from './drawing-buffer';\r\n\r\nlet drawBuffer: DrawingBuffer;\r\nlet blurBuffer: DrawingBuffer;\r\nlet mergeBuffer: DrawingBuffer;\r\n\r\n// Draw edge blur by downsampling image to half size, drawing that first and then drawing sharp image on top\r\nexport function drawWithEdgeBlur(ctx: CanvasRenderingContext2D, width: number, height: number, draw: (ctx: CanvasRenderingContext2D) => void) {\r\n\r\n    let downsample_ratio = 0.5;\r\n    let downsample_alpha = 0.5;\r\n\r\n    if (drawBuffer == null) { drawBuffer = new DrawingBuffer(width, height); }\r\n    drawBuffer.clear(width, height);\r\n\r\n    if (blurBuffer == null) { blurBuffer = new DrawingBuffer(width * downsample_ratio, height * downsample_ratio); }\r\n    blurBuffer.clear(width * downsample_ratio, height * downsample_ratio);\r\n\r\n    if (mergeBuffer == null) { mergeBuffer = new DrawingBuffer(width, height); }\r\n    mergeBuffer.clear(width, height);\r\n\r\n    draw(drawBuffer.context);\r\n    blurBuffer.context.drawImage(drawBuffer.canvas, 0, 0, width, height, 0, 0, width * downsample_ratio, height * downsample_ratio);\r\n    mergeBuffer.context.globalAlpha = downsample_alpha;\r\n    mergeBuffer.context.drawImage(blurBuffer.canvas, 0, 0, width * downsample_ratio, height * downsample_ratio, 0, 0, width, height);\r\n    mergeBuffer.context.globalAlpha = 1;\r\n    mergeBuffer.context.drawImage(drawBuffer.canvas, 0, 0, width, height, 0, 0, width, height);\r\n    ctx.drawImage(mergeBuffer.canvas, 0, 0, width, height, 0, 0, width, height);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/draw-with-blur.ts","const DEBUG = false;\r\n\r\nexport interface DrawingContext {\r\n    width: number;\r\n    height: number;\r\n    context: CanvasRenderingContext2D;\r\n}\r\n\r\nexport class DrawingBuffer {\r\n    canvas: HTMLCanvasElement;\r\n    context: CanvasRenderingContext2D;\r\n\r\n    constructor(width: number, height: number) {\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        if (DEBUG) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n\r\n    clear(width: number, height: number) {\r\n        if (this.canvas.width !== width) {\r\n            this.canvas.width = width;\r\n            this.canvas.height = height;\r\n        }\r\n\r\n        this.context.clearRect(0, 0, width, height);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/drawing-buffer.ts","import { DrawingContext, DrawingBuffer } from './drawing-buffer';\r\nimport { drawWithEdgeBlur } from './draw-with-blur';\r\n\r\nexport interface RelativePoint {\r\n    u: number;\r\n    v: number;\r\n}\r\n\r\nexport interface RelativePosition {\r\n    a: RelativePoint;\r\n    b: RelativePoint;\r\n}\r\n\r\nexport interface ImagePosition extends RelativePosition {\r\n    image: HTMLImageElement | HTMLCanvasElement;\r\n}\r\n\r\nconst buffer = new DrawingBuffer(1200, 1200);\r\n\r\nexport function drawImagesAligned(cOrig: DrawingContext, images: ImagePosition[], shouldDrawPosition: boolean): RelativePosition {\r\n\r\n    // Anti-alias by drawing at a higher scale and resizing after merging\r\n    // const scale = 600 / cOrig.width;\r\n    const scale = 2;\r\n    const wBuffer = scale * cOrig.width;\r\n    const hBuffer = scale * cOrig.height;\r\n    buffer.clear(wBuffer, hBuffer);\r\n\r\n    const c = { context: buffer.context, width: wBuffer, height: hBuffer };\r\n\r\n    // Draw the main image and get it's actual position\r\n    const mainImage = images[0];\r\n    const mainPosition = drawImageCentered(c, mainImage);\r\n\r\n    // Draw each image\r\n    for (let i = 0; i < images.length; i++) {\r\n        if (i === 0) { continue; }\r\n\r\n        drawImageAligned(c, images[i], mainPosition);\r\n    }\r\n\r\n    if (shouldDrawPosition) { drawPosition(c, mainPosition); }\r\n\r\n    // Resize\r\n    cOrig.context.drawImage(buffer.canvas, 0, 0, wBuffer, hBuffer, 0, 0, cOrig.width, cOrig.height);\r\n\r\n    const actualPosition = {\r\n        a: {\r\n            u: mainPosition.a.u / scale,\r\n            v: mainPosition.a.v / scale,\r\n        },\r\n        b: {\r\n            u: mainPosition.b.u / scale,\r\n            v: mainPosition.b.v / scale,\r\n        }\r\n    };\r\n\r\n    return actualPosition;\r\n}\r\n\r\nfunction drawImageCentered(c: DrawingContext, image: ImagePosition): RelativePosition {\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const wImage = image.image.width;\r\n    const hImage = image.image.height;\r\n\r\n    const wScale = w / wImage;\r\n    const hScale = h / hImage;\r\n\r\n    // Fill\r\n    // const scale = Math.max(wScale, hScale);\r\n\r\n    // Fit Inside\r\n    const scale = Math.min(wScale, hScale);\r\n\r\n    // const scale = 1;\r\n\r\n    const x = 0.5 * (w - scale * wImage);\r\n    const y = 0.5 * (h - scale * hImage);\r\n\r\n    c.context.drawImage(image.image,\r\n        0, 0, wImage, hImage,\r\n        x, y, scale * wImage, scale * hImage\r\n    );\r\n\r\n    const mainPosition = {\r\n        a: {\r\n            u: (x + image.a.u * wImage * scale) / w,\r\n            v: (y + image.a.v * hImage * scale) / h,\r\n        },\r\n        b: {\r\n            u: (x + image.b.u * wImage * scale) / w,\r\n            v: (y + image.b.v * hImage * scale) / h,\r\n        },\r\n    };\r\n\r\n    return mainPosition;\r\n}\r\n\r\nfunction drawPosition(c: DrawingContext, position: RelativePosition) {\r\n    drawPoint(c, position.a);\r\n    drawPoint(c, position.b);\r\n}\r\n\r\nfunction drawPoint(c: DrawingContext, point: RelativePoint) {\r\n    const ctx = c.context;\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const color = '#00FF00';\r\n    const radius = 16;\r\n    const thickness = 2;\r\n\r\n    const u = point.u;\r\n    const v = point.v;\r\n\r\n    ctx.globalAlpha = 0.5;\r\n    ctx.lineWidth = thickness;\r\n    ctx.strokeStyle = color;\r\n\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(u * w - radius, v * h);\r\n    // ctx.lineTo(u * w + radius, v * h);\r\n    // ctx.stroke();\r\n\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(u * w, v * h - radius);\r\n    // ctx.lineTo(u * w, v * h + radius);\r\n    // ctx.stroke();\r\n\r\n    ctx.beginPath();\r\n    ctx.fillStyle = color;\r\n    ctx.arc(u * w, v * h, radius, 0, Math.PI * 2, false);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n}\r\n\r\nfunction drawImageAligned(c: DrawingContext, image: ImagePosition, position: RelativePosition) {\r\n    const uAxis = (position.a.u + position.b.u) * 0.5;\r\n    const vAxis = (position.a.v + position.b.v) * 0.5;\r\n\r\n    const uAxis_image = (image.a.u + image.b.u) * 0.5;\r\n    const vAxis_image = (image.a.v + image.b.v) * 0.5;\r\n\r\n    const ctx = c.context;\r\n    const w = c.width;\r\n    const h = c.height;\r\n\r\n    const wImage = image.image.width;\r\n    const hImage = image.image.height;\r\n\r\n\r\n    const posDistance = getDistance(position);\r\n    const imageDistance = getDistance(image);\r\n    const uvScale = posDistance / imageDistance;\r\n    const scale = uvScale * w / wImage;\r\n\r\n    // console.log('distance', posDistance, imageDistance, scale, w, h, wImage, hImage);\r\n\r\n    const posAngle = getAngle(position);\r\n    const imageAngle = getAngle(image);\r\n    const angle = posAngle - imageAngle;\r\n\r\n    const xAxis = w * uAxis;\r\n    const yAxis = h * vAxis;\r\n\r\n    const xImage = xAxis - uAxis_image * scale * wImage;\r\n    const yImage = yAxis - vAxis_image * scale * hImage;\r\n\r\n    ctx.save();\r\n\r\n    ctx.translate(uAxis * w, vAxis * h);\r\n    ctx.rotate(angle);\r\n    ctx.translate(-uAxis * w, -vAxis * h);\r\n\r\n    // ctx.drawImage(image.image,\r\n    //     0, 0, wImage, hImage,\r\n    //     xImage, yImage, scale * wImage, scale * hImage\r\n    // );\r\n\r\n    drawWithEdgeBlur(ctx, w, h, ctx2 => {\r\n        ctx2.drawImage(image.image,\r\n            0, 0, wImage, hImage,\r\n            xImage, yImage, scale * wImage, scale * hImage\r\n        );\r\n    });\r\n\r\n    ctx.restore();\r\n\r\n}\r\n\r\nfunction getDistance(position: RelativePosition): number {\r\n    const uDelta = position.a.u - position.b.u;\r\n    const vDelta = position.a.v - position.b.v;\r\n    return Math.sqrt(uDelta * uDelta + vDelta * vDelta);\r\n}\r\n\r\nfunction getAngle(position: RelativePosition): number {\r\n    const uDelta = position.a.u - position.b.u;\r\n    const vDelta = position.a.v - position.b.v;\r\n    return Math.atan(vDelta / uDelta);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/draw-images-aligned.ts"],"sourceRoot":""}